(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/editRoute/save"],{"054b":function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){return Promise.all([i.e("common/vendor"),i.e("components/uni-calendar/uni-calendar")]).then(i.bind(null,"e2c9"))},r=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"1d7b"))},a=function(){return i.e("components/uni-swipe-action/uni-swipe-action").then(i.bind(null,"11fd"))},s=function(){return Promise.all([i.e("common/vendor"),i.e("components/uni-swipe-action-item/uni-swipe-action-item")]).then(i.bind(null,"e96a"))},u=function(){return Promise.all([i.e("common/vendor"),i.e("components/drag-sort/index")]).then(i.bind(null,"5822"))},c=function(){return i.e("components/h-form-alert/h-form-alert").then(i.bind(null,"d495"))},l={data:function(){return{props:{label:"siteName"},goodDatePickerOption2:{currentRangeStartDate:" ",currentRangeEndDate:" ",isRange:!0},dayChoose:[{text:"增加一天",style:{}},{text:"修改一天",style:{backgroundColor:"rgb(205,129,131)"}},{text:"删除一天",style:{backgroundColor:"rgb(255,58,49)"}},{text:"增加景点",style:{backgroundColor:"rgb(254,156,1)"}}],siteChoose:[{text:"增加景点",style:{}},{text:"删除景点",style:{backgroundColor:"rgb(255,58,49)"}},{text:"修改景点",style:{backgroundColor:"rgb(254,156,1)"}}],modifyDayInputShow:!1,modifySiteInputShow:!1,currentDayId:"",currentDayIndex:"",currentSiteId:"",currentSite:"",currentSiteIndex:[0,0,0],currentSitesList:[],currentSitesList_all:[],sites:{province:["四川","陕西"],city:[["成都","都江堰","内江","大邑"],["西安","延安"]],sites:[[["熊猫基地","成都理工大学"],["都江堰","青城山"],["张大千纪念馆","内江小面"],["安仁古镇","建川博物馆","刘氏庄园"]],[["城墙","大唐不夜城"],["景点1","景点2"]]]},restaurant:{province:["四川","陕西"],city:[["成都","都江堰","内江","大邑"],["西安","延安"]],sites:[[["成都饭店1","成都饭店2"],["都江堰饭店1","都江堰饭店2"],["内江饭店1","内江饭店2"],["大邑饭店1","大邑饭店2","大邑饭店3"]],[["西安饭店1","西安饭店2"],["延安饭店1","延安饭店2"]]]},hotel:{province:["四川","陕西"],city:[["成都","都江堰","内江","大邑"],["西安","延安"]],sites:[[["成都酒店1","成都酒店2"],["都江堰酒店1","都江堰酒店2"],["内江酒店1","内江酒店2"],["大邑酒店1","大邑酒店2","大邑酒店3"]],[["西安酒店1","西安酒店2"],["延安酒店1","延安酒店2"]]]},siteRoute_all:{routeImg:"",routeStartTime:"",routeEndTime:"",routeDay:"",route:[]},routeName:"",userInformation:""}},components:{uniPopup:r,uniCalendar:o,uniSwipeAction:a,uniSwipeActionItem:s,dragSort:u,hFormAlert:c},computed:{currentDateNum:function(){return" "==this.goodDatePickerOption2.currentRangeStartDate?0:this.dateSpace(this.goodDatePickerOption2.currentRangeStartDate,this.goodDatePickerOption2.currentRangeEndDate)}},methods:{onLoad:function(e){this.userInformation=t.getStorageSync("currentUser"),this.load_siteData(this.sites),"{}"!=JSON.stringify(e)&&this.load_routeData(e["routeName"])},onShow:function(){},inital_siteRouteAll:function(){this.siteRoute_all={routeImg:"",routeStartTime:"",routeEndTime:"",routeDay:"",route:[]}},dateSpace:function(t,e){var i,n;return t=Date.parse(t),e=Date.parse(e),i=e-t,i=Math.abs(i),n=Math.floor(i/864e5),n+1},open_calendar:function(){this.$refs.calendar.open()},confirm:function(t){""==t.range.before||""==t.range.after?(this.goodDatePickerOption2.currentRangeStartDate=t.fulldate,this.goodDatePickerOption2.currentRangeEndDate=t.fulldate):(this.goodDatePickerOption2.currentRangeStartDate=t.range.before,this.goodDatePickerOption2.currentRangeEndDate=t.range.after);var e=0;for(this.inital_siteRouteAll(),e;e<this.currentDateNum;e++)this.siteRoute_all["route"].push([])},get_nextDate:function(t,e){var i=t.split("-"),n=new Date(parseInt(i[0]),parseInt(i[1])-1,parseInt(i[2])),o=new Date(Date.parse(n)+24*e*60*60*1e3),r=o.getFullYear(),a=o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1;e=o.getDate()<10?"0"+o.getDate():o.getDate();return r+"-"+a+"-"+e},click_day:function(t,e){switch(t.content.text){case"增加一天":this.add_day(e);break;case"修改一天":this.modify_day(e);break;case"删除一天":this.delete_day(e);break;case"增加景点":this.open_chooseView(e,0);break}},add_day:function(e){" "==this.goodDatePickerOption2.currentRangeStartDate||" "==this.goodDatePickerOption2.currentRangeEndDate?t.showToast({title:"请选择日期",duration:2e3,icon:"none"}):(this.goodDatePickerOption2.currentRangeEndDate=this.get_nextDate(this.goodDatePickerOption2.currentRangeEndDate,1),this.siteRoute_all["route"].splice(e+1,0,[]))},delete_day:function(t){this.siteRoute_all["route"].splice(t,1),0!=this.siteRoute_all["route"].length?this.goodDatePickerOption2.currentRangeEndDate=this.get_nextDate(this.goodDatePickerOption2.currentRangeEndDate,-1):(this.goodDatePickerOption2.currentRangeStartDate=" ",this.goodDatePickerOption2.currentRangeEndDate=" ")},modify_day:function(t){this.modifyDayInputShow=!0,this.currentDayId=t},comfirm_modifyDay:function(e){if(Number(e.modifyDayView)>=0&&Number(e.modifyDayView)<=this.siteRoute_all["route"].length){var i=this.currentDayId,n=e.modifyDayView-1;this.siteRoute_all["route"].splice(n+Number(i<n),0,this.siteRoute_all["route"][i]),this.siteRoute_all["route"].splice(i+Number(i>n),1),this.modifyDayInputShow=!1}else t.showToast({title:"请输入合法天数",duration:2e3,icon:"none"})},cancel_modifyDay:function(){this.modifyDayInputShow=!1},save_route:function(){if(this.routeName){this.siteRoute_all["routeImg"]="/static/editRoute/img1.jpg",this.siteRoute_all["routeStartTime"]=this.goodDatePickerOption2.currentRangeStartDate,this.siteRoute_all["routeEndTime"]=this.goodDatePickerOption2.currentRangeEndDate,this.siteRoute_all["routeDay"]=this.dateSpace(this.goodDatePickerOption2.currentRangeStartDate,this.goodDatePickerOption2.currentRangeEndDate);try{var e=t.getStorageSync(this.userInformation.userName+"_route");if(e)e[this.routeName]=this.siteRoute_all;else{e={};e[this.routeName]=this.siteRoute_all}t.setStorageSync(this.userInformation.userName+"_route",e),n("log",e," at pages\\editRoute\\save.vue:469")}catch(i){}t.showToast({title:"操作成功"}),t.switchTab({url:"../diyRoute/diyRoute"})}},click_site:function(t,e,i){switch(t.content.text){case"增加景点":this.open_chooseView(e,i);break;case"删除景点":this.delete_site(e,i);break;case"修改景点":this.modify_site(e,i);break}},load_data:function(t){switch(t){case"site":this.load_siteData(this.sites);break;case"restaurant":this.load_siteData(this.restaurant);break;case"hotel":this.load_siteData(this.hotel);break}},load_routeData:function(e){var i=t.getStorageSync(this.userInformation.userName+"_route")[e];this.siteRoute_all=i,this.goodDatePickerOption2.currentRangeStartDate=i["routeStartTime"],this.goodDatePickerOption2.currentRangeEndDate=i["routeEndTime"],this.routeName=e},load_siteData:function(t){this.currentSitesList=[],this.currentSiteIndex=[0,0,0],this.currentSitesList_all=t,this.currentSite=t.sites[this.currentSiteIndex[0]][this.currentSiteIndex[1]][this.currentSiteIndex[2]],this.currentSitesList.push(t.province),this.currentSitesList.push(t.city[0]),this.currentSitesList.push(t.sites[0][0])},open_chooseView:function(t,e){this.currentDayIndex=t,this.currentSiteId=e,this.$refs.chooseView.open()},add_site:function(t){this.$refs.chooseView.close(),this.siteRoute_all["route"][this.currentDayIndex].splice(this.currentSiteId+1,0,{siteType:t,siteName:this.currentSite,siteImg:"/static/choosePlace/chengdu.jpg",sitePlayTime:"建议游玩2小时",siteGrade:"评分4.8分"})},change_site:function(t){this.currentSiteIndex[t.detail.column]=t.detail.value,2!=t.detail.column&&(this.currentSiteIndex[t.detail.column+1]=0),this.currentSitesList[1]=this.currentSitesList_all.city[this.currentSiteIndex[0]],this.currentSitesList[2]=this.currentSitesList_all.sites[this.currentSiteIndex[0]][this.currentSiteIndex[1]],this.currentSite=this.currentSitesList_all.sites[this.currentSiteIndex[0]][this.currentSiteIndex[1]][this.currentSiteIndex[2]]},delete_site:function(t,e){this.siteRoute_all["route"][t].splice(e,1)},modify_site:function(t,e){this.modifySiteInputShow=!0,this.currentDayId=t,this.currentSiteId=e},comfirm_modifySite:function(e){if(Number(e.modifySiteView)>=0&&Number(e.modifySiteView)<=this.siteRoute_all["route"][this.currentDayId].length){var i=this.currentSiteId,n=Number(e.modifySiteView)-1;this.siteRoute_all["route"][this.currentDayId].splice(n+Number(i<n),0,this.siteRoute_all["route"][this.currentDayId][i]),this.siteRoute_all["route"][this.currentDayId].splice(i+Number(i>n),1),this.modifySiteInputShow=!1}else t.showToast({title:"请输入合法天数",duration:2e3,icon:"none"})},cancel_modifySite:function(){this.modifySiteInputShow=!1},open_customView:function(t){this.$refs.customView.open()},sub_custom:function(e){""==this.currentSite?t.showToast({title:"请输入自定义景点",duration:2e3,icon:"none"}):(this.add_site("custom"),this.$refs.chooseView.close(),this.$refs.customView.close())},cancel_custom:function(t){this.$refs.customView.close()}}};e.default=l}).call(this,i("6e42")["default"],i("0de9")["default"])},"861b":function(t,e,i){"use strict";i.r(e);var n=i("054b"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);e["default"]=o.a},"9a52":function(t,e,i){"use strict";var n={"uni-calendar":()=>Promise.all([i.e("common/vendor"),i.e("components/uni-calendar/uni-calendar")]).then(i.bind(null,"e2c9")),"uni-swipe-action":()=>i.e("components/uni-swipe-action/uni-swipe-action").then(i.bind(null,"11fd")),"uni-swipe-action-item":()=>Promise.all([i.e("common/vendor"),i.e("components/uni-swipe-action-item/uni-swipe-action-item")]).then(i.bind(null,"e96a")),"uni-popup":()=>i.e("components/uni-popup/uni-popup").then(i.bind(null,"1d7b"))},o=function(){var t=this,e=t.$createElement;t._self._c},r=[];i.d(e,"b",function(){return o}),i.d(e,"c",function(){return r}),i.d(e,"a",function(){return n})},a164:function(t,e,i){"use strict";i.r(e);var n=i("9a52"),o=i("861b");for(var r in o)"default"!==r&&function(t){i.d(e,t,function(){return o[t]})}(r);i("b13d");var a,s=i("f0c5"),u=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);e["default"]=u.exports},ab07:function(t,e,i){},b13d:function(t,e,i){"use strict";var n=i("ab07"),o=i.n(n);o.a},d118:function(t,e,i){"use strict";(function(t){i("6954"),i("921b");n(i("66fd"));var e=n(i("a164"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])}},[["d118","common/runtime","common/vendor"]]]);